<!doctype html>
<html>
<head>

<meta http-equiv="refresh" content="60">
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript">
  var spData = null;
  function doData(json) {
      spData = json.feed.entry;
  }
  
  function drawCell(tr, val) {
      var td = $("<td/>");
      tr.append(td);
      td.append(val);
      return td;
  }
  function drawRow(table, rowData) {
    if (rowData == null) return null;
    if (rowData.length == 0) return null;
    var tr = $("<tr/>");
    table.append(tr);
    for(var c=0; c<rowData.length; c++) {
      drawCell(tr, rowData[c]);
    }
    return tr;
  }
  
  function drawTable(parent) {
    var table = $("<table/>");
    parent.append(table);
    return table;
  }

  function readData(parent) {
    var data = spData;
    var table = drawTable(parent);
    var rowData = [];
	for(var r=0; r<data.length; r++) {
    	var cell = data[r]["gs$cell"];
        var val = cell["$t"];

          var state;
          var hardState;
          var noFac;
          var checkCount;
          var dcCount;
	var last_check;
	var fac_check;
	var fac_checker;
	var checker;
	var dcer;
	var place;

          if (cell.col == 9) {
	          a = cell["$t"];
	          switch(a){
	            case "AK": noFac = "&#128683;"; state = "2024926576"; hardState = "&#128994"; break;
				case "AL": noFac = "&#128683;"; state = "780003738"; hardState = ""; break;
				case "AR": noFac = "&#8505;&#65039;"; state = "1717037408"; hardState = "&#128721"; break;
				case "AS": noFac = "&#128683;"; state = "287389556"; hardState = "&#128994"; break;
				case "AZ": noFac = "&#128683;"; state = "2011360400"; hardState = ""; break;
				case "CA": noFac = "&#8505;&#65039;"; state = "519802721"; hardState = ""; break;
				case "CO": noFac = "&#128683;"; state = "1845652790"; hardState = "&#128721"; break;
				case "CT": noFac = "&#8505;&#65039;"; state = "1078318923"; hardState = ""; break;
				case "DC": noFac = "&#8505;&#65039;"; state = "394697167"; hardState = ""; break;
				case "DE": noFac = "&#8505;&#65039;"; state = "7179835"; hardState = ""; break;
				case "FL": noFac = "&#128683;"; state = "1462315478"; hardState = "&#128721"; break;
				case "GA": noFac = "&#8505;&#65039;"; state = "1018355959"; hardState = "&#128721"; break;
				case "GU": noFac = "&#128683;"; state = "400619256"; hardState = "&#128994"; break;
				case "HI": noFac = "&#8505;&#65039;"; state = "1334938824"; hardState = ""; break;
				case "IA": noFac = "&#8505;&#65039;"; state = "1713611899"; hardState = ""; break;
				case "ID": noFac = "&#8505;&#65039;"; state = "1672710291"; hardState = ""; break;
				case "IL": noFac = "&#8505;&#65039;"; state = "1489418169"; hardState = ""; break;
				case "IN": noFac = "&#8505;&#65039;"; state = "1907227028"; hardState = ""; break;
				case "KS": noFac = "&#8505;&#65039;"; state = "1655547542"; hardState = ""; break;
				case "KY": noFac = "&#8505;&#65039;"; state = "1675609056"; hardState = ""; break;
				case "LA": noFac = "&#8505;&#65039;"; state = "1196761207"; hardState = ""; break;
				case "MA": noFac = "&#128683;"; state = "524370236"; hardState = "&#128994"; break;
				case "MD": noFac = "&#8505;&#65039;"; state = "1939244374"; hardState = ""; break;
				case "ME": noFac = "&#8505;&#65039;"; state = "143707256"; hardState = ""; break;
				case "MI": noFac = "&#8505;&#65039;"; state = "762609068"; hardState = ""; break;
				case "MN": noFac = "&#8505;&#65039;"; state = "1407835627"; hardState = ""; break;
				case "MO": noFac = "&#128683;"; state = "366859734"; hardState = ""; break;
				case "MP": noFac = "&#128683;"; state = "809372907"; hardState = "&#128994"; break;
				case "MS": noFac = "&#8505;&#65039;"; state = "1704539776"; hardState = ""; break;
				case "MT": noFac = "&#128683;"; state = "1751721338"; hardState = "&#128994"; break;
				case "NC": noFac = "&#8505;&#65039;"; state = "886292337"; hardState = ""; break;
				case "ND": noFac = "&#8505;&#65039;"; state = "1789741675"; hardState = ""; break;
				case "NE": noFac = "&#128683;"; state = "1072015810"; hardState = ""; break;
				case "NH": noFac = "&#128683;"; state = "1025945808"; hardState = ""; break;
				case "NJ": noFac = "&#8505;&#65039;"; state = "46783232"; hardState = ""; break;
				case "NM": noFac = "&#8505;&#65039;"; state = "815643678"; hardState = ""; break;
				case "NV": noFac = "&#128683;"; state = "1355672772"; hardState = "&#128994"; break;
				case "NY": noFac = "&#8505;&#65039;"; state = "1193401934"; hardState = ""; break;
				case "OH": noFac = "&#128683;"; state = "1877325295"; hardState = ""; break;
				case "OK": noFac = "&#8505;&#65039;"; state = "1746127488"; hardState = ""; break;
				case "OR": noFac = "&#8505;&#65039;"; state = "439474235"; hardState = ""; break;
				case "PA": noFac = "&#8505;&#65039;"; state = "1426836143"; hardState = ""; break;
				case "PR": noFac = "&#128683;"; state = "93704517"; hardState = "&#128994"; break;
				case "RI": noFac = "&#8505;&#65039;"; state = "1916753092"; hardState = ""; break;
				case "SC": noFac = "&#8505;&#65039;"; state = "2131262441"; hardState = ""; break;
				case "SD": noFac = "&#128683;"; state = "1867054847"; hardState = ""; break;
				case "TN": noFac = "&#8505;&#65039;"; state = "1701198364"; hardState = ""; break;
				case "TX": noFac = "&#128683;"; state = "1540415125"; hardState = ""; break;
				case "UT": noFac = "&#128683;"; state = "1686890535"; hardState = "&#128994"; break;
				case "VA": noFac = "&#8505;&#65039;"; state = "1952426465"; hardState = ""; break;
				case "VI": noFac = "&#128683;"; state = "81592428"; hardState = "&#128994"; break;
				case "VT": noFac = "&#128683;"; state = "30062261"; hardState = ""; break;
				case "WA": noFac = "&#128683;"; state = "857877107"; hardState = ""; break;
				case "WI": noFac = "&#128683;"; state = "1751317996"; hardState = ""; break;
				case "WV": noFac = "&#8505;&#65039;"; state = "1653752275"; hardState = ""; break;
				case "WY": noFac = "&#8505;&#65039;"; state = "2090820915"; hardState = ""; break;
	            }
	        }

          if (cell.col == 9) {
            prefix = noFac + ' <a href = "https://docs.google.com/spreadsheets/d/1FFAY0CY9wRTspgc1Zt3Ltd8jcKN4HPAFFr_4nLqBQB0/edit#gid=' + state + '" target = "sheet">';
		  suffix = "</a> " + hardState; 
          }
          else {
            prefix = "";
            suffix = "";
	  } 
          		
		if ( cell.row == 1 && (cell.col == 6 || cell.col == 7)) {
			if (cell.col == 6) { place = "<b>Checks Left:</b> <br>" + cell["$t"] }
			if (cell.col == 7) { place = "<b>DC Left:</b> <br>" + cell["$t"] } 
          		
        		rowData.push(place);
        		if (cell.col == 7) {
              		id = cell["$t"];
              		drawRow(table, rowData, id);
              		rowData = [];
          		}
        	}

		if ( cell.row == 2 && cell.col == 1 ) {
			last_check = "<b>Last CHK</b>"
			fac_check = "<b>Fac CHK</b>"
			fac_checker = "<b>Fac CHKer</b>"
			checker = "<b>CHKer</b>"
			dcer = "<b>DCer</b>"
			place = "<b>State</b>" 
          		
        		rowData.push(fac_checker);
        		rowData.push(fac_check);
        		rowData.push(place);
        		rowData.push(last_check);
        		rowData.push(checker);
        		rowData.push(dcer);
              		id = cell["$t"];
              		drawRow(table, rowData, id);
              		rowData = [];
        	}

			 if ( cell.row > 2 && cell.row%2 == 1 && (cell.col == 9 || cell.col == 3 || cell.col == 4 || cell.col == 5 || cell.col == 6 || cell.col == 7)) {
	          	if (cell.col == 3) { last_check = cell["$t"] }
	          	if (cell.col == 4) { fac_check = cell["$t"] }
	          	if (cell.col == 5) { fac_checker = cell["$t"] }
	          	if (cell.col == 6) { checker  = cell["$t"] }
	          	if (cell.col == 7) { dcer  = cell["$t"] }
	          	if (cell.col == 9) { place  = prefix + cell["$t"] + suffix }
          		
        		if (cell.col == 9) {
        		rowData.push(fac_checker);
        		rowData.push(fac_check);
        		rowData.push(place);
        		rowData.push(last_check);
        		rowData.push(checker);
        		rowData.push(dcer);
              		id = cell["$t"];
              		drawRow(table, rowData, id);
              		rowData = [];
          		}
        	}
      	}
      drawRow(table, rowData);
  }
  $(document).ready(function(){
      readData($("#data"));
  });

  </script>   
  
<script src="https://spreadsheets.google.com/feeds/cells/1FFAY0CY9wRTspgc1Zt3Ltd8jcKN4HPAFFr_4nLqBQB0/1/public/values?alt=json-in-script&callback=doData"></script>
<style type="text/css">
  table {border-collapse: collapse; width: 200;}
  th, td {border: thin solid black; padding: 3px;}
  tr.head th, tr.head td {background-color: #EDEDED; border-bottom: 4px double black;}
  span.linetitle {font-weight: bold;}
  div.lineclass {font-style: italic;}
  .title, .result {width: 80%;}
  .notes {width: 15%;}
  h1 {text-align: center;}
  body {margin: 12px; font-size: 12px;}
</style>
<style type="text/css" media="print">
  form {display: none;}
</style>
</head>
<body>
<h2>Welcome to LTC Data Entry</h2>
<h3>Based on Race Dash by Alice Goldfarb</h3>
<div id="data"/>
</body>
</html> 
