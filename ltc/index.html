<!doctype html>
<html>
<head>

<meta http-equiv="refresh" content="60">
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript">
  var spData = null;
  function doData(json) {
      spData = json.feed.entry;
  }
  
  function drawCell(tr, val) {
      var td = $("<td/>");
      tr.append(td);
      td.append(val);
      return td;
  }
  function drawRow(table, rowData) {
    if (rowData == null) return null;
    if (rowData.length == 0) return null;
    var tr = $("<tr/>");
    table.append(tr);
    for(var c=0; c<rowData.length; c++) {
      drawCell(tr, rowData[c]);
    }
    return tr;
  }
  
  function drawTable(parent) {
    var table = $("<table/>");
    parent.append(table);
    return table;
  }

  function readData(parent) {
    var data = spData;
    var table = drawTable(parent);
    var rowData = [];
	for(var r=0; r<data.length; r++) {
    	var cell = data[r]["gs$cell"];
        var val = cell["$t"];

          var state;
          var hardState;
          var checkCount;
          var dcCount;
	var last_check;
	var checker;
	var dcer;
	var place;

          if (cell.col == 8) {
	          a = cell["$t"];
	          switch(a){
	            case "AK": state = "2024926576"; hardState = "&#128994"; break;
				case "AL": state = "780003738"; hardState = ""; break;
				case "AR": state = "1717037408"; hardState = ""; break;
				case "AS": state = "287389556"; hardState = "&#128994"; break;
				case "AZ": state = "2011360400"; hardState = ""; break;
				case "CA": state = "519802721"; hardState = ""; break;
				case "CO": state = "1845652790"; hardState = ""; break;
				case "CT": state = "1078318923"; hardState = ""; break;
				case "DC": state = "394697167"; hardState = ""; break;
				case "DE": state = "7179835"; hardState = ""; break;
				case "FL": state = "1462315478"; hardState = ""; break;
				case "GA": state = "1018355959"; hardState = ""; break;
				case "GU": state = "400619256"; hardState = "&#128994"; break;
				case "HI": state = "1334938824"; hardState = ""; break;
				case "IA": state = "1713611899"; hardState = ""; break;
				case "ID": state = "1672710291"; hardState = ""; break;
				case "IL": state = "1489418169"; hardState = ""; break;
				case "IN": state = "1907227028"; hardState = ""; break;
				case "KS": state = "1655547542"; hardState = ""; break;
				case "KY": state = "1675609056"; hardState = ""; break;
				case "LA": state = "1196761207"; hardState = ""; break;
				case "MA": state = "524370236"; hardState = "&#128994"; break;
				case "MD": state = "1939244374"; hardState = ""; break;
				case "ME": state = "143707256"; hardState = ""; break;
				case "MI": state = "762609068"; hardState = ""; break;
				case "MN": state = "1407835627"; hardState = ""; break;
				case "MO": state = "366859734"; hardState = ""; break;
				case "MP": state = "809372907"; hardState = "&#128994"; break;
				case "MS": state = "1704539776"; hardState = ""; break;
				case "MT": state = "1751721338"; hardState = "&#128994"; break;
				case "NC": state = "886292337"; hardState = ""; break;
				case "ND": state = "1789741675"; hardState = ""; break;
				case "NE": state = "1072015810"; hardState = ""; break;
				case "NH": state = "1025945808"; hardState = ""; break;
				case "NJ": state = "46783232"; hardState = ""; break;
				case "NM": state = "815643678"; hardState = ""; break;
				case "NV": state = "1355672772"; hardState = "&#128994"; break;
				case "NY": state = "1193401934"; hardState = ""; break;
				case "OH": state = "1877325295"; hardState = ""; break;
				case "OK": state = "1746127488"; hardState = ""; break;
				case "OR": state = "439474235"; hardState = ""; break;
				case "PA": state = "1426836143"; hardState = ""; break;
				case "PR": state = "93704517"; hardState = "&#128994"; break;
				case "RI": state = "1916753092"; hardState = ""; break;
				case "SC": state = "2131262441"; hardState = ""; break;
				case "SD": state = "1867054847"; hardState = ""; break;
				case "TN": state = "1701198364"; hardState = ""; break;
				case "TX": state = "1540415125"; hardState = ""; break;
				case "UT": state = "1686890535"; hardState = "&#128994"; break;
				case "VA": state = "1952426465"; hardState = ""; break;
				case "VI": state = "81592428"; hardState = ""; break;
				case "VT": state = "30062261"; hardState = "&#128994"; break;
				case "WA": state = "857877107"; hardState = ""; break;
				case "WI": state = "1751317996"; hardState = ""; break;
				case "WV": state = "1653752275"; hardState = ""; break;
				case "WY": state = "2090820915"; hardState = ""; break;
	            }
	        }

          if (cell.col == 8) {
            prefix = '<a href = "https://docs.google.com/spreadsheets/d/1FFAY0CY9wRTspgc1Zt3Ltd8jcKN4HPAFFr_4nLqBQB0/edit#gid=' + state + '" target = "sheet">';
		  suffix = "</a> " + hardState; 
          }
          else {
            prefix = "";
            suffix = "";
	  } 
          		
		if ( cell.row == 1 && (cell.col == 5 || cell.col == 6)) {
          		if (cell.col == 5) { place = "Checks Left: <br>" + cell["$t"] }
			if (cell.col == 6) { place = "DC Left: <br>" + cell["$t"] } 
          		
        		rowData.push(place);
        		if (cell.col == 6) {
              		id = cell["$t"];
              		drawRow(table, rowData, id);
              		rowData = [];
          		}
        	}

		if ( cell.row == 2 && cell.col == 1 ) {
			last_check = "Last Check: <br>"
			checker = "Checker: <br>"
			dcer = "DCer: <br>"
			place = "State: <br>" 
          		
        		rowData.push(place);
        		rowData.push(last_check);
        		rowData.push(checker);
        		rowData.push(dcer);
              		id = cell["$t"];
              		drawRow(table, rowData, id);
              		rowData = [];
        	}

		if ( cell.row > 2  && (cell.col == 8 || cell.col == 4 || cell.col == 5 || cell.col == 6)) {
	          	if (cell.col == 4) { last_check = cell["$t"] }
	          	if (cell.col == 5) { checker  = cell["$t"] }
	          	if (cell.col == 6) { dcer  = cell["$t"] }
	          	if (cell.col == 8) { place  = prefix + cell["$t"] + suffix }
          		
        		if (cell.col == 8) {
        		rowData.push(place);
        		rowData.push(last_check);
        		rowData.push(checker);
        		rowData.push(dcer);
              		id = cell["$t"];
              		drawRow(table, rowData, id);
              		rowData = [];
          		}
        	}
      	}
      drawRow(table, rowData);
  }
  $(document).ready(function(){
      readData($("#data"));
  });

  </script>   
  
<script src="https://spreadsheets.google.com/feeds/cells/1FFAY0CY9wRTspgc1Zt3Ltd8jcKN4HPAFFr_4nLqBQB0/1/public/values?alt=json-in-script&callback=doData"></script>
<style type="text/css">
  table {border-collapse: collapse; width: 200;}
  th, td {border: thin solid black; padding: 3px;}
  tr.head th, tr.head td {background-color: #EDEDED; border-bottom: 4px double black;}
  span.linetitle {font-weight: bold;}
  div.lineclass {font-style: italic;}
  .title, .result {width: 80%;}
  .notes {width: 15%;}
  h1 {text-align: center;}
  body {margin: 12px; font-size: 12px;}
</style>
<style type="text/css" media="print">
  form {display: none;}
</style>
</head>
<body>
<h2>Welcome to LTC Data Entry</h2>
<h3>Based on Race Dash by Alice Goldfarb</h3>
<div id="data"/>
</body>
</html> 
